<h1 class="steps-count">Step 1 of 3</h1>
<h2>What do you want to deploy?</h2>
<br>

<% if @latest_tag || @tags || @branches || @commits %>
  <p class="lead muted">
    Select the
    <% if @latest_tag %>
      <%= deploy_type_icon("tag") %> <strong>latest tag</strong>
    <% elsif @tags %>
      <%= deploy_type_icon("tag") %> <strong>tag</strong>
    <% elsif @branches %>
      <%= deploy_type_icon("branch") %> <strong>branch</strong>
    <% elsif @commits %>
      <%= deploy_type_icon("commit") %> <strong>commit</strong>
    <% end %>
    that you wish to ship.
  </p>
<% end %>

<div>
  <% if @branches %>
    <%= form_tag repo_branches_path(current_repo.name), method: "get", class: "form-inline pull-right" do %>
      <div class="form-group">
        <label class="sr-only" for="search">Search</label>
        <%= text_field_tag "search", params[:search], class: "form-control", id: "search", placeholder: "Enter branch name" %>
      </div>
      <button type="submit" class="btn btn-default">Search</button>
    <%- end %>
  <% end %>
  <ul class="nav nav-tabs deploy-targets">
    <% if supported?("tag") %>
    <li <%= 'class="active"'.html_safe if @latest_tag %>>
      <%= link_to latest_repo_tags_path(current_repo.name) do %>
        <%= deploy_type_icon("tag") %> Latest Tag
      <%- end %>
    </li>
    <li <%= 'class="active"'.html_safe if @tags %>>
      <%= link_to repo_tags_path(current_repo.name) do %>
        <%= deploy_type_icon("tag") %> Tags
      <%- end %>
    </li>
    <% end %>
    <% if supported?("branch") %>
    <li <%= 'class="active"'.html_safe if @branches %>>
      <%= link_to repo_branches_path(current_repo.name) do %>
        <%= deploy_type_icon("branch") %> Branches
      <%- end %>
    </li>
    <% end %>
    <% if supported?("commit") %>
    <li <%= 'class="active"'.html_safe if @commits %>>
      <%= link_to repo_commits_path(current_repo.name) do %>
        <%= deploy_type_icon("commit") %> Commits
      <%- end %>
    </li>
    <% end %>
  </ul>
  <br>

  <% if @tags %>
    <%= render partial: 'repos/tags', locals: { tags: @tags } %>
  <% elsif @branches %>
    <%= render partial: 'repos/branches', locals: { branches: @branches } %>
  <% elsif @commits %>
    <%= render partial: 'repos/commits', locals: { commits: @commits } %>
  <% elsif @latest_tag %>
    <%= render partial: 'repos/latest_tag', locals: { foo: "bar", latest_tag: @latest_tag } %>
  <% else %>
    <div class="container">
      <h3 class="muted"><i class="icon-circle-arrow-up"></i>
        Select where to grab the code.
      </h3>
      <% if current_repo.name == "pardot" %>
        <br>
        <h4>
          Or deploy the
          <%= link_to latest_repo_tags_path(current_repo.name) do %>
            <i class="icon-tags"></i> latest tag
          <%- end %>
        </h4>
      <% end %>
    </div>
  <% end %>
</div>
