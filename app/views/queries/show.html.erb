<%= render partial: 'form' %>
Parsed Query: <%= @ast.try(:to_sql) %>
<div>
  <table class="table table-striped">
    <thead>
    <tr>
    <% @result.fields.each_with_index do |field, i| %>
      <th>
        <%= link_to field, "#", class: 'select_column' %>
        <% if !@query.select_all? && (i == @result.fields.length-1) %>
          <%= select_tag(:add_column, options_for_select(table_columns.unshift("Add column", "Show all"))) %>
        <% end %>
      </th>
    <% end %>
    </tr>
    </thead>
    <tbody>
    <% @result.each do |fields| %>
      <tr>
        <% fields.each do |field| %>
        <td class="filterable-cell"><%= field %></td>
        <% end %>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>
<%= link_to("Show All Rows", "#", class: "all_rows") if @query.is_limited %>