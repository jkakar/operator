<% if @query.account? %>
<div id="account_id">
    <span>Account: <%= @query.account.descriptive_name %></span>
</div>
<% end %>
<%= form_for @query, url: query_form_path do |f| %>
  <%= f.hidden_field :database %>
  <%= f.hidden_field :is_limited %>
  <%= f.hidden_field :view %>
  <div class="btn-group view">
    <button type="button" class="btn btn-default<%= is_active?(:view, VW::SQL) %>" data-val="<%= VW::SQL %>">I like my SQL</button>
    <button type="button" class="btn btn-default<%= is_active?(:view, VW::UI) %>" data-val="<%= VW::UI %>">Pretty UI View</button>
  </div>
  <%= f.hidden_field :datacenter %>
  <div class="btn-group datacenter">
    <button type="button" class="btn btn-default<%= is_active?(:datacenter, DataCenter::DALLAS) %>" data-val="<%= DataCenter::DALLAS %>">Dallas</button>
    <button type="button" class="btn btn-default<%= is_active?(:datacenter, DataCenter::SEATTLE) %>" data-val="<%= DataCenter::SEATTLE %>">Seattle</button>
  </div>
  <div class="viewoption" <%= is_active?(:view, VW::UI, 'style="display:none;"') %>>
    <%= f.text_area(:sql, rows: "6") %>
    <%= f.submit "Run Query" %>
  </div>
  <div class="viewoption" <%= is_active?(:view, VW::SQL, 'style="display:none;"') %>>
    <table class="table table-striped scrollable">
      <% @query.tables.each do |table| %>
        <tr>
          <td class="filterable-cell"><a href="#" class="account_helper"><%= table %></a></td>
        </tr>
      <% end %>
    </table>
  </div>
<% end %>

<% if @query.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@query.errors.count, "error") %> prohibited this query from being entered:</h2>

    <ul>
    <% @query.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end %>
    </ul>
  </div>
<% end %>
