#!/usr/bin/env bash
set -eu

git ls-files |
grep -v src/build/vendor |
grep -v src/github.com/hashicorp/terraform |
grep -v github.com/grpc-ecosystem/grpc-gateway |
grep -v github.com/go-swagger |
while read f; do
    if file "$f" | grep -q -E "bash script|POSIX shell"; then
        if ! shellcheck -f gcc "$f"; then
            exit 1
        fi
    fi
done

true
