#!/usr/bin/env bash
#/ Usage: docker-push <app>
#/ Push an app image to the internal Docker registry hosted on Artifactory.
set -euo pipefail

. etc/build/env

app="${1:-""}"
if [ "$app" = "--help" ] || [ -z "$app" ]; then
    grep ^#/ <"$0" | cut -c4-
    exit 1
fi

repo="$DOCKER_REPO_BREAD/$app/app:$(docker-image-tag)"
echo "Pushing container image to ${repo}..." 2>&1
docker tag "${app}_app" "$repo"
docker push "$repo"
