#!/usr/bin/env bash
set -euo pipefail
# Workaround for <https://github.com/docker/libnetwork/issues/1113>
# Please remove when the bug is resolved, and a fixed version deployed
if [ -x "/bin/systemctl" ] && [ "$(hostname -f | cut -d. -f2-4)" != "internal.salesforce.com" ]
then
    docker network ls --filter='type=custom' | sed 1d | awk '{print $2}' | xargs -r docker network rm || true
    sudo /bin/systemctl restart docker.service
    sleep 5
fi
