// Code generated by protoc-gen-operatord
package main

import (
	"errors"
	"flag"
	"os"
	"strings"

	"google.golang.org/grpc"

	ping "bread/ping"
)

func buildOperatorServer(
	server *grpc.Server,
	flags *flag.FlagSet,
) (map[string]error, error) {
	pingConfig := &ping.PingerConfig{}
	services := make(map[string]error)
	if err := flags.Parse(os.Args[1:]); err != nil {
		return services, err
	}
	errs := make(map[string][]string)
	if len(errs["ping"]) != 0 {
		services["ping"] = errors.New("required flag(s) missing: " + strings.Join(errs["ping"], ", "))
	} else {
		pingServer, err := ping.NewAPIServer(pingConfig)
		if err != nil {
			services["ping"] = err
		} else {
			ping.RegisterPingerServer(server, pingServer)
			services["ping"] = nil
		}
	}
	return services, nil
}
